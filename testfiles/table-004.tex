\documentclass{article}

\input{regression-test}

\begin{document}

\START
\hrule\bigskip

\BEGINTEST{table nesting: same rule width}
\SetTblrDefault{rows={rowsep=0pt}}
\begin{tabular}{|l|l|l|l|}
\hline
  One & \begin{tabular}{ll}111&111 \\\hline 222&222 \\\hline 333&333\end{tabular} & Big & Big \\
\hline
  Small & Big & One & Big \\
\hline
\end{tabular}
\begin{tblr}{|l|l|l|l|}
\hline
  One & \begin{tblr}{ll}111&111 \\\hline 222&222 \\\hline 333&333\end{tblr} & Big & Big \\
\hline
  Small & Big & One & Big \\
\hline
\end{tblr}
\ENDTEST

\bigskip\hrule\bigskip

\BEGINTEST{table nesting: different rule widths}
\begin{tblr}{|Q|Q|Q|Q|}
\hline
  One & \begin{tblr}{hlines={2pt},vlines={2pt}}111 \\ 222 \\ 333\end{tblr} & Big & Big \\
\hline
  Small & Big & One & Big \\
\hline
\end{tblr}
\ENDTEST

\bigskip\hrule\bigskip

\BEGINTEST{table nesting: restore table commands #31}
\begin{tabular}{c}
\hline
  Outer Cell \\
\hline
  \begin{tblr}{c}
  \hline
    text \\
  \hline
  \end{tblr} \\
\hline
  $\begin{tblr}{c}
  \hline
    a+b \\
  \hline
  \end{tblr}$ \\
\hline
\end{tabular}
\quad
\begin{tblr}{c}
\hline
  Outer Cell \\
\hline
  \begin{tabular}{c}
  \hline
    text \\
  \hline
  \end{tabular} \\
\hline
  $\begin{array}{c}
  \hline
    a+b \\
  \hline
  \end{array}$ \\
\hline
\end{tblr}
\quad
\begin{tabular}{c}
\hline
  Outer Cell \\
\hline
  \begin{tblr}{c}
  \SetHline{-}{1pt}
    text \\
  \SetHline{-}{1pt}
  \end{tblr} \\
\hline
  $\begin{tblr}{c}
  \SetHline{-}{1pt}
    a+b \\
  \SetHline{-}{1pt}
  \end{tblr}$ \\
\hline
\end{tabular}
\quad
\begin{tblr}{c}
\SetHline{-}{dashed}
  Outer Cell \\
\SetHline{-}{dashed}
  \begin{tabular}{c}
  \hline
    text \\
  \hline
  \end{tabular} \\
\SetHline{-}{dashed}
  $\begin{array}{c}
  \hline
    a+b \\
  \hline
  \end{array}$ \\
\SetHline{-}{dashed}
\end{tblr}
\ENDTEST

\end{document}
